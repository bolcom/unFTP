<!doctype html>

<html lang="en">

<head>
    <meta charset="utf-8">

    <title>Anti password guessing</title>
    <meta name="description" content="Documentation for unFTP">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Source+Sans+Pro:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&display=swap"
        rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="/assets/normalize.css?v=1737229553"
        media="screen" />
    <link rel="stylesheet" type="text/css" href="/assets/doctave-style.css?v=1737229553"
        media="screen" />
    <link rel="stylesheet" type="text/css" href="/assets/katex.css?v=1737229553" media="screen" />
    <link rel="stylesheet" type="text/css" href="/assets/prism-ghcolors.css?v=1737229553"
        media="screen" />

    <script>
        var DOCTAVE_TIMESTAMP = "1737229553";
        var BASE_PATH = "/";
        var color = localStorage.getItem('doctave-color')

        if (color === 'dark') {
            document.getElementsByTagName('html')[0].classList.remove('light');
            document.getElementsByTagName('html')[0].classList.add('dark');
        } else {
            document.getElementsByTagName('html')[0].classList.remove('dark');
            document.getElementsByTagName('html')[0].classList.add('light');
        }
    </script>

    
</head>

<body>
    <label for='menu-toggle-switch' class='menu-toggle-button'>
        â˜°
    </label>
    <input type="checkbox" id="menu-toggle-switch" value='0' />
    <div class='page'>
        <div class='header'>
            <div class='logo'>
                
                <a href="/">
                    <img src="/assets/logo.png" alt='unFTP logo'></img>
                </a>
                
                <h2 class='project-name'>
                    <a href="/">
                        unFTP
                    </a>
                </h2>
            </div>
            <div class='search'>
                <form id='search-form'>
    <input type='text' id='search-box' autocomplete="off" placeholder="Search..."></input>
    <span class='search-icon'>S</span>
    <ul id='search-results'></ul>
</form>

            </div>
            <div class='header-dummy-right'>
            </div>
        </div>
        <div class='container'>
            <div class='sidebar-left'>
                <nav class='site-nav'>
    <ul>
        
            <li><a href="/libunftp">The Library</a></li>
            
        
            <li><a href="/server">The Server</a></li>
            
                <ul>
    
        <li><a href="/server/installation">Installation</a></li>
        
    
        <li><a href="/server/starting">unFTP Up</a></li>
        
    
        <li><a href="/server/logging">Logging</a></li>
        
    
        <li><a href="/server/monitoring">Monitoring</a></li>
        
    
        <li><a href="/server/ftps">Enabling TLS</a></li>
        
    
        <li><a href="/server/gcs">Cloud Storage</a></li>
        
    
        <li><a href="/server/jsonconfig">Per User Config</a></li>
        
    
        <li><a href="/server/rest">REST auth</a></li>
        
    
        <li><a href="/server/http-usr">User config over HTTP</a></li>
        
    
        <li><a href="/server/pubsub">Pub/Sub</a></li>
        
    
        <li><a class="active" href="/server/anti-brute">Anti password guessing</a></li>
        
    
        <li><a href="/server/proxy-protocol">Proxy Protocol</a></li>
        
    
        <li><a href="/server/docker">Docker</a></li>
        
    
</ul>

            
        
            <li><a href="/support">Support</a></li>
            
        
            <li><a href="/licensing">Licensing</a></li>
            
        
    </ul>
    <span id='light-dark-mode-switch'>
        <svg xmlns="http://www.w3.org/2000/svg" id="dark-mode-icon" viewBox="0 0 20 20" fill="currentColor">
            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z" />
        </svg>

        <svg xmlns="http://www.w3.org/2000/svg" id="light-mode-icon" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd" />
        </svg>
    </span>
</nav>

            </div>
            <div class='doctave-content'>
                <p>To protect your FTP server against <a href="https://en.wikipedia.org/wiki/Brute-force_attack">password guessing attacks</a>, you can enable a "Failed logins policy".
This temporarily blocks the account if too many failed logins occur.</p>
<p>You can start up unFTP with the default failed logins policy:</p>
<pre><code class="language-sh">unftp --failed-logins-policy
</code></pre>
<p>By default, 3 subsequent unsuccessful login attempts block further login attempts for that user orginating from that source IP for 5 minutes.</p>
<p>How to adjust these parameters and the default policy is explained in the sections below.</p>
<h2 id="adjust-max-attempts-and-duration">Adjust max attempts and duration</h2>
<p>To change this to block after <code>5</code> attempts instead of <code>3</code>:</p>
<pre><code class="language-sh">unftp --failed-logins-policy --failed-max-attempts 5
</code></pre>
<p>To change this to block for 30 minutes (<code>1800</code> seconds) instead of 5 minutes (<code>300</code> seconds):</p>
<pre><code class="language-sh">unftp --failed-logins-policy --failed-expire-after 1800
</code></pre>
<h2 id="choose-another-policy">Choose another policy</h2>
<p>By default, the temporary block applies to the <em>combination of username and source IP</em>.
When an attacker is blocked by this policy, attempts to use other accounts, or attempts from different source IPs can still succeed.
You can adjust this behavior by blocking based on source IP or username instead.</p>
<p>Block by source IP instead of both IP and username:</p>
<pre><code class="language-sh">unftp --failed-logins-policy ip
</code></pre>
<p>Block by username instead of both IP and username:</p>
<pre><code class="language-sh">unftp --failed-logins-policy user
</code></pre>
<p>Be aware that user level -only blocking may also affect legitimate login attempts.</p>
<h2 id="example">Example</h2>
<p>Block an attacker based on source IP for 30 minutes after 5 unsuccessful login attempts:</p>
<pre><code class="language-sh">unftp \
  --failed-logins-policy ip \
  --failed-max-attempts 5 \
  --failed-expire-after 1800
</code></pre>

            </div>
            <div class='sidebar-right'>
                <div class='page-nav' id='page-nav'>
                    <p class='page-nav-header'>On this page</p>
                    <ul>
                        
                        <li class='page-nav-level-2'>
                            <a href='#adjust-max-attempts-and-duration'>Adjust max attempts and duration</a>
                        </li>
                        
                        <li class='page-nav-level-2'>
                            <a href='#choose-another-policy'>Choose another policy</a>
                        </li>
                        
                        <li class='page-nav-level-2'>
                            <a href='#example'>Example</a>
                        </li>
                        
                    </ul>
                </div>
            </div>
            <div class='wave-container'>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320">
                    <path fill-opacity="0.35"
                        d="M0,192L60,213.3C120,235,240,277,360,277.3C480,277,600,235,720,192C840,149,960,107,1080,122.7C1200,139,1320,213,1380,250.7L1440,288L1440,320L1380,320C1320,320,1200,320,1080,320C960,320,840,320,720,320C600,320,480,320,360,320C240,320,120,320,60,320L0,320Z">
                    </path>
                    <path fill-opacity="0.5"
                        d="M0,160L60,181.3C120,203,240,245,360,229.3C480,213,600,139,720,138.7C840,139,960,213,1080,229.3C1200,245,1320,203,1380,181.3L1440,160L1440,320L1380,320C1320,320,1200,320,1080,320C960,320,840,320,720,320C600,320,480,320,360,320C240,320,120,320,60,320L0,320Z">
                    </path>
                    <path fill-opacity="0.2"
                        d="M0,224L60,197.3C120,171,240,117,360,117.3C480,117,600,171,720,186.7C840,203,960,181,1080,186.7C1200,192,1320,224,1380,240L1440,256L1440,320L1380,320C1320,320,1200,320,1080,320C960,320,840,320,720,320C600,320,480,320,360,320C240,320,120,320,60,320L0,320Z">
                    </path>
                </svg>
                <p>Powered by <a href='https://cli.doctave.com' target='_blank'>Doctave</a></p>
            </div>
        </div>
    </div>
    <script type="text/javascript" src="/assets/katex.js?v=1737229553"></script>
    <script type="text/javascript" src="/assets/mermaid.js?v=1737229553"></script>
    <script type="text/javascript" src="/assets/elasticlunr.js?v=1737229553"></script>
    <script type="text/javascript" src="/assets/prism.js?v=1737229553"></script>
    <script type="text/javascript" src="/assets/doctave-app.js?v=1737229553"></script>

    
</body>

</html>